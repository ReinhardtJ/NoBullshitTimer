@page "/"
@using NoBullshitTimer.Domain
@using NoBullshitTimer.View
@implements IDisposable
<PageTitle>Index</PageTitle>
<h1>NoBullshitTimer</h1>
<p>An interval timer that just works</p>
<p>no ads, no subscription, no annoying UI, no unnecessary features, every device, open source and simple: <b>no bullshit</b></p>
<h2>Current Exercise: @_intervalTimer.CurrentExercise</h2>
<span>Next Exercise: @_intervalTimer.NextExercise</span>
<h1>@_intervalTimerView.SecondsLeftFormatted()</h1>
<h1>@_intervalTimer.TimerState</h1>
<h1>Interval Progress: @_intervalTimerView.ProgressText</h1>
<p>@_intervalTimerView.PauseInformation</p>
<button @onclick="_intervalTimer.PreviousInterval"> Previous Interval</button>
<button @onclick="_intervalTimer.PlayPause">
    Play / Pause</button>
<button @onclick="_intervalTimer.NextInterval"> Next Interval </button>

<h2>Edit</h2>

@code {

    private Timer? _timer;
    private IntervalTimer _intervalTimer ;
    private IntervalTimerView _intervalTimerView;

    protected override void OnInitialized()
    {
        _intervalTimer = new IntervalTimer(40, 20, 3, ["push ups", "pull ups"]);
        _intervalTimerView = new IntervalTimerView(_intervalTimer);

        _timer = new Timer(_ =>
        {
            _intervalTimer.Tick();
            InvokeAsync(StateHasChanged);
        }, null, 0L, 1000L);

    }

    public void Dispose()
    {
        _timer?.Dispose();
        _timer = null;
    }
}
